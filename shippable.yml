# Language setting http://docs.shippable.com/ci/languages/node/
language: java
jdk: oraclejdk8

# use this to control what branches get built.
# http://docs.shippable.com/ci/advancedOptions/branches/
branches:
  only:
    - master
#
## using pre-defined build variables
## full list http://docs.shippable.com/ci/advancedOptions/environmentVariables/
#env:
#  global:
#    - TEST_RESULTS_DIR=$SHIPPABLE_REPO_DIR/shippable/testresults
#    - CODE_COVERAGE_DIR=$SHIPPABLE_REPO_DIR/shippable/codecoverage
#    - TESTS_LOC_DIR=$SHIPPABLE_REPO_DIR/src/test/java/
#    - MOD_LOC=$SHIPPABLE_REPO_DIR/node_modules/.bin/



build:

#  cache: true
#  cache_dir_list:
#    - /root/.m2

  pre_ci:
#    image_name: xxxxx
#    image_tag: latest
#    pull: true
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage
    - mkdir -p shippable/target
    - mkdir -p shippable/yulitarget
    - ls
    - cd shippable
    - ls

  ci:
    - shippable_retry mvn clean install
    - shippable_retry mvn clean test -Dtest=DemoRunner cobertura:cobertura
#    - shippable_retry mvn clean cobertura:cobertura
#    - cp -r target shippable/yulitarget
    - cp -r $SHIPPABLE_BUILD_DIR/target ./shippable/target
    - cp -r $SHIPPABLE_BUILD_DIR/target/surefire-reports ./shippable/testresults
    - cp -r $SHIPPABLE_BUILD_DIR/target/surefire-reports ./shippable/codecoverage
    - echo "Checking Files"
    - pwd
    - ls
    - cd target/cobertura
    - ls
    #    - cd shippable/target
    #    - ls
    - cd ../../shippable
    - ls
    - cd target
    - ls
    - cd cobertura
    - ls
    - pwd
    - cd $SHIPPABLE_BUILD_DIR/target
    - pwd
    - ls
#    - cd ~/shippable/target/surefire-reports
#    - ls
#    - cd ./shippable/buildoutput
#    - ls
#    - cd ./shippable/codecoverage
#    - ls
#    - cd ./shippable/testresults
#    - ls

#  post_ci:
#    - echo "Checking Files"
#    - ls
#    - cd target/cobertura
#    - ls
##    - cd shippable/target
##    - ls
#    - cd ../../shippable
#    - ls
#    - cd target
#    - ls
#    - cd ../buildoutput
#    - ls
#    - cd ../codecoverage
#    - ls
#    - cd ../testresults
#    - ls



